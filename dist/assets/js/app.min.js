/*! mota-reporte-revista-2019 v0.1.0 | (c) 2019  | MIT License | git+https://github.com/Dejusticia/mota-reporte-revista-2019.git */
!(function(e,r){"function"==typeof define&&define.amd?define([],(function(){return r(e)})):"object"==typeof exports?module.exports=r(e):e.Gumshoe=r(e)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(e){"use strict";var r,t,n,a,s,o,i,c,l,u,d,m,p,g,f,v=0,y=function(e){var r=(function(e){var r,t=parseUri(sanitizeHTML(String(e)));if(-1===t.host.indexOf("gov.co"))throw d.classList.remove("inactive"),d.innerHTML="<p>El enlace que buscó no es válido!</p><p>Por favor, use una URL .gov.co de um sítio web existente.</p>",new Error("This URI is invalid");return r=t.host.replace(/\./g,"-"),{host:t.host,basename:r,reportBasename:"report-"+r}})(e);i.forEach((function(e,r){e.innerHTML='<div role="progressbar" class="mdc-linear-progress mdc-linear-progress--indeterminate"><div class="mdc-linear-progress__buffering-dots"></div><div class="mdc-linear-progress__buffer"></div><div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar"><span class="mdc-linear-progress__bar-inner"></span></div><div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar"><span class="mdc-linear-progress__bar-inner"></span></div></div>'})),atomic("https://dejusticia.github.io/mota-reports/"+r.reportBasename+".json").then((function(e){return u=e.data,L(u),u})).catch((function(e){T()}))},b=function(e,i){if("recommendation"===i.type)switch(i.grade){case"AAA":o.prepend(e);break;case"AA":s.prepend(e);break;default:a.prepend(e)}else switch(i.grade){case"AAA":n.prepend(e);break;case"AA":t.prepend(e);break;default:r.prepend(e)}},h=function(e,r){var t=r.ruleId,n=e.querySelector(".results-criteria-grade meter"),a=e.querySelector(".results-criteria-grade label"),s=e.querySelector(".results-criteria");return e.querySelector("summary").innerText=r.title,e.querySelector("details p").innerHTML=r.shortDescription+' <a href="'+r.ruleSpecificationUrl+'" class="more-link" target="mota-specs">Más Informaciones.</a>',s.setAttribute("id","criteria-"+t),a.innerText=r.grade,a.setAttribute("for","grade-"+t),n.setAttribute("value",r.gradePoints),n.setAttribute("id","grade-"+t),n.setAttribute("name","grade-"+t),n.innerText=r.gradePoints,e},L=function(e){var r,t=e.rules,n=e.meta.lastEvaluationDate;d.classList.add("inactive"),m.classList.add("inactive"),p.classList.add("inactive"),g.innerHTML="",f.innerHTML="";for(var a=0;a<t.length;a++){var s=t[a];s.grade;0===a?v=+s.gradePoints:(s.gradePoints=+s.gradePoints,v+=s.gradePoints),console.log("generalGrade ="),console.log(v);var o=document.getElementById("template-results-criteria").content.cloneNode(!0);o=h(o,s),b(o,s)}(function(e){var r="";r=(e=+e)<20?"Deficiente ("+e+")":e<50?"Insuficiente ("+e+")":e<90?" Parcial, debe mejorar ("+e+")":e<100?"Bien ("+e+")":"Perfecto! ("+e+")",m.value=e,p.innerHTML=r,m.classList.remove("inactive"),p.classList.remove("inactive")})(v=Math.floor(v/t.length)),g.innerHTML='<span class="screen-reader-text">URL:</span>'+e.meta.entityUrl,f.innerHTML='<span class="screen-reader-text">Fecha de Evaluación:</span>'+(r=(r=(r=n).replace("T"," - ")).substring(0,r.length-6))},T=function(){throw d.classList.remove("inactive"),d.innerHTML="<p>No se encontró el informe para esta evaluación. Estamos agregando a nuestra cola de evaluación y, si existe el sitio, tendremos la evaluación en unas pocas horas.</p>",console.error("error code",error.status),console.error("error description",error.statusText),new Error("This request returned an error with the code:\n"+error.status)};r=document.querySelector(".legal-obligations.unsatisfactory .results-content"),t=document.querySelector(".legal-obligations.partial .results-content"),n=document.querySelector(".legal-obligations.satisfactory .results-content"),a=document.querySelector(".recommendations.unsatisfactory .results-content"),s=document.querySelector(".recommendations.partial .results-content"),o=document.querySelector(".recommendations.satisfactory .results-content"),c=document.getElementById("evaluate-form"),l=document.getElementById("evaluate-url"),document.getElementById("results-summary"),d=document.getElementById("results-summary-error"),m=document.getElementById("results-grade-final"),p=document.querySelector('label[for="results-grade-final"]'),g=document.getElementById("results-summary-url"),f=document.getElementById("results-summary-date"),i=document.querySelectorAll(".results-content"),document.addEventListener("submit",(function(e){e.preventDefault(),c===e.target&&(console.log(l.value),y(l.value))}),!1)}));